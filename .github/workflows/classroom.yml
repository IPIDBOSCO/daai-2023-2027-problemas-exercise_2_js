name: Autograding Tests
'on':
  - push
  - repository_dispatch

permissions:
  checks: write
  actions: read
  contents: read

jobs:
  run-autograding-tests:
    runs-on: ubuntu-latest
    if: github.actor != 'github-classroom[bot]'
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup pnpm
        uses: pnpm/action-setup@v4

      - name: Install dependencies
        run: pnpm install

      - name: Dados
        id: dados
        uses: classroom-resources/autograding-command-grader@v1
        with:
          test-name: Dados
          setup-command: ''
          command: pnpm run test dice
          timeout: 10
          max-score: 20

      - name: Ordenamiento
        id: ordenamiento
        uses: classroom-resources/autograding-command-grader@v1
        with:
          test-name: Ordenamiento
          setup-command: ''
          command: pnpm run test order
          timeout: 10
          max-score: 20

      - name: Matriz
        id: matriz
        uses: classroom-resources/autograding-command-grader@v1
        with:
          test-name: Matriz
          setup-command: ''
          command: pnpm run test matrix
          timeout: 10
          max-score: 20

      - name: Tarea
        id: tarea
        uses: classroom-resources/autograding-command-grader@v1
        with:
          test-name: Tarea
          setup-command: ''
          command: pnpm run test task
          timeout: 10
          max-score: 20

      - name: Archivo
        id: archivo
        uses: classroom-resources/autograding-command-grader@v1
        with:
          test-name: Archivo
          setup-command: ''
          command: pnpm run test file
          timeout: 10
          max-score: 20

      - name: Autograding Reporter
        uses: classroom-resources/autograding-grading-reporter@v1
        env:
          TEST_RESULTS: |
            ${{steps.dados.outputs.result}}
            ${{steps.ordenamiento.outputs.result}}
            ${{steps.matriz.outputs.result}}
            ${{steps.tarea.outputs.result}}
            ${{steps.archivo.outputs.result}}
      with:
        runners: dados,ordenamiento,matriz,tarea,archivo
